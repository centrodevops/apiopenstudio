account:
  columns:
    accid: { type: int(10) unsigned, notnull: true, primary: true, autoincrement: true, comment: account id }
    name: { type: varchar(255), notnull: true, comment: account name }
  data:
    - { name: gaterdata }

application:
  columns:
    appid: { type: int(10) unsigned, notnull: true, primary: true, autoincrement: true, comment: application id }
    accid: { type: int(10) unsigned, notnull: true, comment: account id }
    name: { type: varchar(255), notnull: true, comment: application name }
  data:
    - { accid: 1, name: testing }
    - { accid: 1, name: core }

user:
  columns:
    uid: { type: int(10) unsigned, notnull: true, primary: true, autoincrement: true, comment: user id }
    active: { type: tinyint(4), notnull: true, default: 1, comment: user status }
    username: { type: varchar(255), notnull: true, comment: user name }
    hash: { type: varchar(64), default: NULL, comment: pasword hash }
    token: { type: varchar(32), default: NULL, comment: temporary access token }
    token_ttl: { type: timestamp, default: NULL, comment: end of life for token }
    email: { type: varchar(255), notnull: true, comment: user email address }
    honorific: { type: varchar(16), default: NULL, comment: users title }
    name_first: { type: varchar(255), default: NULL, comment: first name }
    name_last: { type: varchar(255), default: NULL, comment: last name }
    company: { type: varchar(255), default: NULL, comment: company name }
    website: { type: varchar(255), default: NULL, comment: company url }
    address_street: { type: varchar(255), default: NULL, comment: user number and street name }
    address_suburb: { type: varchar(255), default: NULL, comment: user address and suburb }
    address_city: { type: varchar(255), default: NULL, comment: user city }
    address_state: { type: varchar(255), default: NULL, comment: user state }
    address_country: { type: varchar(255), default: NULL, comment: user country }
    address_postcode: { type: varchar(16), default: NULL, comment: user postcode }
    phone_mobile: { type: varchar(32), default: NULL, comment: user mobile number }
    phone_work: { type: varchar(32), default: NULL, comment: user work number }

role:
  columns:
    rid: { type: int(10) unsigned, notnull: true, primary: true, autoincrement: true, comment: role id }
    name: { type: varchar(255), notnull: true, comment: title of role }
  data:
    - { name: Administrator }
    - { name: Account manager }
    - { name: Application manager }
    - { name: Developer }
    - { name: Consumer }

user_role:
  columns:
    urid: { type: int(10) unsigned, notnull: true, primary: true, autoincrement: true, comment: user role id }
    accid: { type: int(10) unsigned, notnull: false, comment: "account id, we allow null for owner role" }
    appid: { type: int(10) unsigned, notnull: false, comment: "application id, we allow null for owner role" }
    uid: { type: int(10) unsigned, notnull: true, comment: user id }
    rid: { type: int(10) unsigned, notnull: true, comment: role id }

invite:
  columns:
    iid: { type: int(10) unsigned, notnull: true, primary: true, autoincrement: true, comment: invite id }
    email: { type: varchar(255), default: true, comment: invite email address }
    token: { type: varchar(255), notnull: true, comment: invite token }

resource:
  columns:
    resid: { type: int(10) unsigned, notnull: true, primary: true, autoincrement: true, comment: resource id }
    appid: { type: int(10) unsigned, notnull: true, comment: application id }
    name: { type: varchar(255), notnull: true, comment: name of the resource }
    description : { type: varchar(2048), notnull: true, comment: description of the resource }
    method: { type: text, notnull: true, comment: form delivery method }
    uri: { type: varchar(64), notnull: true, comment: URI of the api call }
    meta: { type: varchar(16384), notnull: true, comment: all of the actions taken by the call }
    ttl: { type: int(10) unsigned, notnull: true, default: 300, comment: time to cache the results (seconds) }

external_user:
  columns:
    euid: { type: int(10) unsigned, notnull: true, primary: true, autoincrement: true, comment: external user id }
    appid: { type: int(10) unsigned, notnull: true, comment: application id }
    external_id: { type: varchar(255), notnull: true, comment: user id in external entity }
    external_entity: { type: varchar(255), notnull: true, comment: name of the external entity }
    data_field_1: { type: varchar(255), notnull: false, comment: extra data field 1 }
    data_field_2: { type: varchar(255), notnull: false, comment: extra data field 2 }
    data_field_3: { type: varchar(255), notnull: false, comment: extra data field 3 }

blacklist:
  columns:
    blid: { type: int(10) unsigned, notnull: true, primary: true, autoincrement: true, comment: blacklist id }
    appid: { type: int(10) unsigned, notnull: true, comment: application id }
    min_ip: { type: varchar(32), notnull: true, comment: ip range minimum }
    max_ip: { type: varchar(32), notnull: true, comment: ip range maximum }

whitelist:
  columns:
    wlid: { type: int(10) unsigned, notnull: true, primary: true, autoincrement: true, comment: whitelist id }
    appid: { type: int(10) unsigned, notnull: true, comment: application id }
    min_ip: { type: varchar(32), notnull: true, comment: ip range minimum }
    max_ip: { type: varchar(32), notnull: true, comment: ip range maximum }

log:
  columns:
    lid: { type: int(10) unsigned, notnull: true, primary: true, autoincrement: true, comment: log id }
    datetime: { type: timestamp, notnull: true, default: CURRENT_TIMESTAMP, comment: log time and date }
    user: { type: varchar(255), notnull: true, comment: user name }
    ip: { type: varchar(11), notnull: true, comment: user id }
    type: { type: varchar(64), notnull: true, comment: call type }
    text: { type: varchar(1024), notnull: true, comment: log text }

var_store:
  columns:
    vid: { type: int(10) unsigned, notnull: true, primary: true, autoincrement: true, comment: var id }
    appid: { type: int(10) unsigned, notnull: true, comment: application id }
    key: { type: varchar(255), notnull: true, comment: key of the var }
    val: { type: varchar(255), notnull: true, comment: value of the var }
