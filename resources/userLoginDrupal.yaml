name: User login Drupal

description: Login a user to the system, using user/pass validation on an external Drupal site

uri: user/login/drupal

method: post

ttl: 0

process:
  function: loginStoreDrupal
  id: 1
  source:
    function: url
    id: 2
    source:
      function: concatenate
      id: 3
      sources:
        - function: varPersistent
          id: 4
          name: drupalUrl
          operation: fetch
        - "api/anon/user/login"
    method: post
    reportError: true
    normalise: true
    vars:
      username:
        function: varPost
        id: 5
        name: username
      password:
        function: varPost
        id: 6
        name: password
    curlOpts:
      CURLOPT_SSL_VERIFYPEER: 0
      CURLOPT_FOLLOWLOCATION: 1
